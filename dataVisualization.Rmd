```{r}
library(tidyverse)
library(ggplot2)
```

```{r}
weatherES <- read_csv("weatherES.csv")
```
```{r}
house <- read_csv("houseWeather.csv")
```


```{r}
county <- unique(weatherES$in.county)
```


```{r}
wData <- aggregate(total ~in.county, data= weatherES, FUN = sum, na.rm=TRUE)
```


```{r}
aggEnergy<- read_csv("aggEnergy.csv")
```

```{r}
dayWeather <- aggregate(total ~day(time), data=aggEnergy, FUN = sum, na.rm = TRUE)
```

```{r}
dayWeather <- dayWeather[order(dayWeather$total),]
```


```{r}
head(dayWeather)
```

```{r}
tail(dayWeather)
```

```{r}
ggplot(dayWeather, aes(`day(time)`,total)) + geom_col()
```


```{r}
weekWeather <- aggregate(total ~wday(time), data=aggEnergy, FUN = sum, na.rm = TRUE)
weekWeather <- weekWeather[order(weekWeather$total),]
```


```{r}
weekWeather
```

```{r}
ggplot(weekWeather, aes(`wday(time)`,total)) + geom_col()
```


```{r}
ggplot(wData, aes(total,in.county)) + geom_col(orientation="y")
```



```{r}
boxplot(weatherES$`Relative Humidity [%]`,
        col = c("blue"),
        horizontal = TRUE,
        ylab = "Relative Humidity",
        border = "brown",
        xlab = "Relative Humidity %")
```

```{r}
boxplot(weatherES$`Dry Bulb Temperature [°C]`,
        col = c("red"),
        horizontal = TRUE,
        ylab = "Temperature",
        border = "purple",
        xlab = "Temperature")
```

```{r}
ggplot(data=weatherES) + aes(x=`Dry Bulb Temperature [°C]`, y=total) + geom_point() +
geom_smooth(method="lm", se=FALSE)
```